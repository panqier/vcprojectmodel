import os, shutil, random, glob

base = "/Users/qierpan/vcmodel/trashnet/dataset-resized"
train_dir = "/Users/qierpan/vcmodel/dataset/images/train"
val_dir = "/Users/qierpan/vcmodel/dataset/images/val"

os.makedirs(train_dir, exist_ok=True)
os.makedirs(val_dir, exist_ok=True)

classes = os.listdir(base)
for cls in classes:
    cls_path = os.path.join(base, cls)
    if not os.path.isdir(cls_path):
        continue

    imgs = glob.glob(os.path.join(cls_path, "*.jpg"))
    random.shuffle(imgs)
    split = int(0.8 * len(imgs))
    for i, img in enumerate(imgs):
        dst = train_dir if i < split else val_dir
        shutil.copy(img, os.path.join(dst, f"{cls}_{os.path.basename(img)}"))

